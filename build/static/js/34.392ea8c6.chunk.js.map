{"version":3,"sources":["components/license/License.style.ts","components/license/License.presenter.tsx","components/license/License.query.ts","components/license/License.container.tsx","utils/priceToString.ts"],"names":["LicenseWrapper","styled","div","LicenseTitle","LicenseTableHeaderWrapper","LicenseTableLeftHeader","LicenseTableRightHeader","LicenseTableContentsWrapper","LicenseTablePeriodTitle","LicenseTablePeriodNumber","span","LicenseTablePeriodContent","LicenseTablePriceTitle","LicenseTablePriceContent","LicenseTableBuyTitle","LicenseTableBuyContent","LicenseTableBuyBtn","button","LicenseNoticeWrapper","LicenseNoticeTitle","LicenseNoticeContents","LicenseModalTilte","LicenseModalText","LicenseModalBtnWrapper","LicenseModalCancelBtn","LicenseModalBtn","LicensePresenter","handleBuy","setPaymentInput","paymentInput","open","handleOpen","handleClose","onClick","title","period","price","Modal","onClose","Box","sx","position","top","left","transform","width","bgcolor","border","boxShadow","p","display","flexDirection","priceToString","String","FETCH_USER","gql","UPDATE_SUBSCRIPTION_USER","CREATE_SUBSCRIPTION_HISTORY","LicenseContainer","userId","sessionStorage","getItem","navigate","useNavigate","useState","setOpen","User","useQuery","variables","id","data","useMutation","createSubscription","updateSubscriptionUser","a","alert","handleInnoPay","InnoPayResult","result","JSON","parse","ResultCode","postPayment","window","removeEventListener","code","moment","format","innopay","goPay","PayMethod","MID","process","MerchantKey","GoodsName","Amt","BuyerName","user","name","BuyerTel","phone","BuyerEmail","email","ResultYN","Moid","Currency","addEventListener","input","paymentStatus","paymentMethod","isSubscribe","handleAlreadySubscriptionUser","createSubscriptionHistory","subscriptionHistory","handelUpdateSubscriptionUser","created_at","createdAt","subscriptionDate","expirationDate","Date","dayjs","add","where","newDate","type","src","charSet","toString","replace"],"mappings":"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","file":"static/js/34.392ea8c6.chunk.js","sourcesContent":["import styled from \"@emotion/styled\";\n\nexport const LicenseWrapper = styled.div`\n  max-width: 1920px;\n  min-width: 1100px;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding-top: 70px;\n  padding-bottom: 100px;\n`;\n\nexport const LicenseTitle = styled.div`\n  font-size: 20px;\n  margin-bottom: 43px;\n`;\n\nexport const LicenseTableHeaderWrapper = styled.div`\n  display: flex;\n  width: 1100px;\n  border-top: 1px solid #c1c1c1;\n  border-bottom: 1px solid #c1c1c1;\n`;\n\nexport const LicenseTableLeftHeader = styled.div`\n  width: 260px;\n  height: 46px;\n  font-family: SpoqaHanSansNeo-Bold;\n  background-color: #f3f3f3;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border-right: 1px solid #c1c1c1;\n`;\n\nexport const LicenseTableRightHeader = styled.div`\n  width: 840px;\n  height: 46px;\n  font-family: SpoqaHanSansNeo-Bold;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background-color: #f3f3f3;\n`;\n\nexport const LicenseTableContentsWrapper = styled.div`\n  display: flex;\n  width: 1100px;\n  border-bottom: 1px solid #c1c1c1;\n`;\n\nexport const LicenseTablePeriodTitle = styled.div`\n  width: 260px;\n  height: 141px;\n  font-family: SpoqaHanSansNeo-Bold;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background-color: #f3f3f3;\n`;\nexport const LicenseTablePeriodNumber = styled.span`\n  font-size: 32px;\n  font-family: GmarketSansBold;\n  padding-bottom: 7px;\n`;\nexport const LicenseTablePeriodContent = styled.div`\n  width: 277px;\n  height: 141px;\n  display: flex;\n  font-family: SpoqaHanSansNeo-Bold;\n  justify-content: center;\n  align-items: center;\n  border-left: 1px solid #c1c1c1;\n`;\n\nexport const LicenseTablePriceTitle = styled.div`\n  width: 260px;\n  height: 95px;\n  font-family: SpoqaHanSansNeo-Bold;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background-color: #f3f3f3;\n`;\nexport const LicenseTablePriceContent = styled.div`\n  width: 277px;\n  height: 95px;\n  display: flex;\n  font-family: SpoqaHanSansNeo-Bold;\n  justify-content: center;\n  align-items: center;\n  border-left: 1px solid #c1c1c1;\n`;\n\nexport const LicenseTableBuyTitle = styled.div`\n  width: 260px;\n  height: 80px;\n  font-family: SpoqaHanSansNeo-Bold;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background-color: #f3f3f3;\n`;\nexport const LicenseTableBuyContent = styled.div`\n  width: 277px;\n  height: 80px;\n  display: flex;\n  font-family: SpoqaHanSansNeo-Bold;\n  justify-content: center;\n  align-items: center;\n  border-left: 1px solid #c1c1c1;\n`;\n\nexport const LicenseTableBuyBtn = styled.button`\n  width: 144px;\n  height: 48px;\n  color: white;\n  font-family: SpoqaHanSansNeo-Bold;\n  background-color: #4033a2;\n  border: none;\n  outline: none;\n  cursor: pointer;\n`;\n\nexport const LicenseNoticeWrapper = styled.div`\n  width: 1100px;\n  display: flex;\n  flex-direction: column;\n`;\n\nexport const LicenseNoticeTitle = styled.div`\n  font-family: SpoqaHanSansNeo-Bold;\n  margin-top: 50px;\n  margin-bottom: 20px;\n`;\n\nexport const LicenseNoticeContents = styled.div`\n  font-size: 14px;\n  color: #999999;\n`;\n\nexport const LicenseModalTilte = styled.div`\n  font-family: SpoqaHanSansNeo-Bold;\n  margin-bottom: 16px;\n  align-self: center;\n`;\n\nexport const LicenseModalText = styled.div``;\n\nexport const LicenseModalBtnWrapper = styled.div`\n  display: flex;\n  justify-content: space-between;\n  margin-top: 16px;\n`;\n\nexport const LicenseModalCancelBtn = styled.button`\n  width: 137px;\n  height: 46px;\n  background-color: white;\n  color: black;\n  font-size: 14px;\n  cursor: pointer;\n  border: 1px solid black;\n  outline: none;\n`;\n\nexport const LicenseModalBtn = styled.button`\n  width: 137px;\n  height: 46px;\n  background-color: #4033a2;\n  color: white;\n  font-size: 14px;\n  cursor: pointer;\n  border: none;\n  outline: none;\n`;\n","import {\n  LicenseModalBtn,\n  LicenseModalBtnWrapper,\n  LicenseModalCancelBtn,\n  LicenseModalText,\n  LicenseModalTilte,\n  LicenseNoticeContents,\n  LicenseNoticeTitle,\n  LicenseNoticeWrapper,\n  LicenseTableBuyBtn,\n  LicenseTableBuyContent,\n  LicenseTableBuyTitle,\n  LicenseTableContentsWrapper,\n  LicenseTableHeaderWrapper,\n  LicenseTableLeftHeader,\n  LicenseTablePeriodContent,\n  LicenseTablePeriodNumber,\n  LicenseTablePeriodTitle,\n  LicenseTablePriceContent,\n  LicenseTablePriceTitle,\n  LicenseTableRightHeader,\n  LicenseTitle,\n  LicenseWrapper,\n} from \"./License.style\";\nimport { Box, Modal } from \"@mui/material\";\nimport { priceToString } from \"../../utils/priceToString\";\ninterface ILicenseProps {\n  handleBuy: () => void;\n  setPaymentInput: React.Dispatch<\n    React.SetStateAction<{\n      title: string;\n      price: number;\n      period: number;\n    }>\n  >;\n  paymentInput: {\n    title: string;\n    price: number;\n    period: number;\n  };\n  open: boolean;\n  handleOpen: () => void;\n  handleClose: () => void;\n}\n\nconst LicensePresenter: React.FC<ILicenseProps> = ({\n  handleBuy,\n  setPaymentInput,\n  paymentInput,\n  open,\n  handleOpen,\n  handleClose,\n}) => {\n  return (\n    <LicenseWrapper>\n      <LicenseTitle>라이센스 구매</LicenseTitle>\n      <LicenseTableHeaderWrapper>\n        <LicenseTableLeftHeader>서비스 명</LicenseTableLeftHeader>\n        <LicenseTableRightHeader>\n          금융빅데이터 구독 상품\n        </LicenseTableRightHeader>\n      </LicenseTableHeaderWrapper>\n      <LicenseTableContentsWrapper>\n        <LicenseTablePeriodTitle>사용기간</LicenseTablePeriodTitle>\n        <LicenseTablePeriodContent>\n          <LicenseTablePeriodNumber>1</LicenseTablePeriodNumber> 개월\n        </LicenseTablePeriodContent>\n        <LicenseTablePeriodContent>\n          <LicenseTablePeriodNumber>3</LicenseTablePeriodNumber> 개월\n        </LicenseTablePeriodContent>\n        <LicenseTablePeriodContent>\n          <LicenseTablePeriodNumber>6</LicenseTablePeriodNumber> 개월\n        </LicenseTablePeriodContent>\n      </LicenseTableContentsWrapper>\n      <LicenseTableContentsWrapper>\n        <LicenseTablePriceTitle>사용기간</LicenseTablePriceTitle>\n        <LicenseTablePriceContent>330,000원</LicenseTablePriceContent>\n        <LicenseTablePriceContent>900,000원</LicenseTablePriceContent>\n        <LicenseTablePriceContent>1,650,000원</LicenseTablePriceContent>\n      </LicenseTableContentsWrapper>\n      <LicenseTableContentsWrapper>\n        <LicenseTableBuyTitle>사용기간</LicenseTableBuyTitle>\n        <LicenseTableBuyContent>\n          <LicenseTableBuyBtn\n            onClick={() => {\n              handleOpen();\n              setPaymentInput({\n                ...paymentInput,\n                title: \"1개월 프리미엄 구독 상품\",\n                period: 1,\n                price: 1,\n              });\n            }}\n          >\n            구매\n          </LicenseTableBuyBtn>\n        </LicenseTableBuyContent>\n        <LicenseTableBuyContent>\n          <LicenseTableBuyBtn\n            onClick={() => {\n              handleOpen();\n              setPaymentInput({\n                ...paymentInput,\n                title: \"3개월 프리미엄 구독 상품\",\n                period: 3,\n                price: 1,\n              });\n            }}\n          >\n            구매\n          </LicenseTableBuyBtn>\n        </LicenseTableBuyContent>\n        <LicenseTableBuyContent>\n          <LicenseTableBuyBtn\n            onClick={() => {\n              handleOpen();\n              setPaymentInput({\n                ...paymentInput,\n                title: \"6개월 프리미엄 구독 상품\",\n                period: 6,\n                price: 1,\n              });\n            }}\n          >\n            구매\n          </LicenseTableBuyBtn>\n        </LicenseTableBuyContent>\n      </LicenseTableContentsWrapper>\n      <LicenseNoticeWrapper>\n        <LicenseNoticeTitle>라이센스 유의 사항</LicenseNoticeTitle>\n        <LicenseNoticeContents>\n          - 12개월 회원의 경우 무제한 다운로드(단, 해외이미지의 경우 1일/150컷\n          제한), 6개월 회원의 경우 1일/50컷 다운로드 가능합니다.\n          <br /> - 모든 라이선스 사용 기반은 국내(한국, 한국어)입니다. 해외 사용\n          시 국가/언어 당 별도 협의가 필요합니다. <br />- 싱글동영상,\n          싱글에프터이펙트, 싱글음원, 싱글플러스팩의 경우 별도 라이선스 구매 후\n          다운로드 및 이용 가능합니다. <br />- 클립아트코리아에서 제공되는\n          폰트는 구매하신 이미지 라이선스와 동일한 사용범위 내에서 사용\n          가능합니다. <br />- 다만 일부 폰트의 경우 이미지 라이선스를 구매했을\n          지라도 지상파TV, 종편TV, 케이블TV방송, 영화에 사용이 불가하오니,\n          반드시 상세페이지 내 폰트별 사용범위를 확인 하시고 이용하시기\n          바랍니다.\n        </LicenseNoticeContents>\n      </LicenseNoticeWrapper>\n      <Modal\n        open={open}\n        onClose={handleClose}\n        aria-labelledby=\"modal-modal-title\"\n        aria-describedby=\"modal-modal-description\"\n      >\n        <Box\n          sx={{\n            position: \"absolute\" as \"absolute\",\n            top: \"50%\",\n            left: \"50%\",\n            transform: \"translate(-50%, -50%)\",\n            width: 400,\n            bgcolor: \"background.paper\",\n            border: \"2px solid #000\",\n            boxShadow: 24,\n            p: 4,\n            display: \"flex\",\n            flexDirection: \"column\",\n          }}\n        >\n          <LicenseModalTilte>결제 상품 확인</LicenseModalTilte>\n          <LicenseModalText>상품명: {paymentInput.title}</LicenseModalText>\n          <LicenseModalText>\n            가격: {priceToString(String(paymentInput.price))} 원\n          </LicenseModalText>\n          <LicenseModalText>\n            구독 기간: {paymentInput.period} 개월\n          </LicenseModalText>\n          <LicenseModalBtnWrapper>\n            <LicenseModalCancelBtn onClick={handleClose}>\n              취소\n            </LicenseModalCancelBtn>\n            <LicenseModalBtn onClick={handleBuy}>결제</LicenseModalBtn>\n          </LicenseModalBtnWrapper>\n        </Box>\n      </Modal>\n    </LicenseWrapper>\n  );\n};\n\nexport default LicensePresenter;\n","import { gql } from \"@apollo/client\";\n\nexport const FETCH_USER = gql`\n  query user($id: ID!) {\n    user(id: $id) {\n      username\n      email\n      name\n      phone\n      isSubscribe\n      expirationDate\n    }\n  }\n`;\n\nexport const UPDATE_SUBSCRIPTION_USER = gql`\n  mutation updateUser($input: updateUserInput) {\n    updateUser(input: $input) {\n      user {\n        id\n        expirationDate\n      }\n    }\n  }\n`;\n\nexport const CREATE_SUBSCRIPTION_HISTORY = gql`\n  mutation createSubscriptionHistory($input: createSubscriptionHistoryInput) {\n    createSubscriptionHistory(input: $input) {\n      subscriptionHistory {\n        id\n        created_at\n        period\n      }\n    }\n  }\n`;\n","import { useMutation, useQuery } from \"@apollo/client\";\nimport { Helmet, HelmetProvider } from \"react-helmet-async\";\nimport moment from \"moment\";\nimport { useState } from \"react\";\nimport { useNavigate } from \"react-router\";\nimport {\n  Mutation,\n  MutationCreateSubscriptionHistoryArgs,\n  MutationUpdateUserArgs,\n  Query,\n  QueryUserArgs,\n} from \"../../commons/types/generated/types\";\nimport LicensePresenter from \"./License.presenter\";\nimport {\n  FETCH_USER,\n  CREATE_SUBSCRIPTION_HISTORY,\n  UPDATE_SUBSCRIPTION_USER,\n} from \"./License.query\";\nimport dayjs from \"dayjs\";\n\nconst REACT_APP_INNOPAY_MID = process.env.REACT_APP_INNOPAY_MID;\nconst REACT_APP_INNOPAY_MERCHANTKEY = process.env.REACT_APP_INNOPAY_MERCHANTKEY;\n\nconst LicenseContainer = () => {\n  const userId = sessionStorage.getItem(\"userId\");\n  const navigate = useNavigate();\n\n  const [paymentInput, setPaymentInput] = useState({\n    title: \"1개월 프리미엄 구독 상품\",\n    price: 0,\n    period: 0,\n  });\n\n  //* 결제 모달\n  const [open, setOpen] = useState(false);\n  const handleOpen = () => {\n    setOpen(true);\n  };\n  const handleClose = () => setOpen(false);\n\n  //* 유저 정보\n  const { data: User } = useQuery<Query, QueryUserArgs>(FETCH_USER, {\n    variables: {\n      id: String(userId),\n    },\n  });\n\n  //* 구독 상품 결제\n  const [createSubscription] = useMutation<\n    Mutation,\n    MutationCreateSubscriptionHistoryArgs\n  >(CREATE_SUBSCRIPTION_HISTORY);\n\n  //* 유저의 구독 정보 업데이트\n  const [updateSubscriptionUser] = useMutation<\n    Mutation,\n    MutationUpdateUserArgs\n  >(UPDATE_SUBSCRIPTION_USER);\n\n  //* 구매버튼\n  const handleBuy = async () => {\n    if (!sessionStorage.getItem(\"accessToken\")) {\n      alert(\"로그인 후 이용 가능합니다.\");\n      navigate(\"/login\");\n      return;\n    }\n\n    handleInnoPay();\n  };\n\n  const InnoPayResult = (data: any) => {\n    if (data.data === \"close\") {\n      window.removeEventListener(\"message\", InnoPayResult);\n      return;\n    } else if (data.data !== \"close\") {\n      var result = JSON.parse(data.data);\n      //* 아래 데이터는 필요할 경우 사용하세요\n      // var mid = data.data.MID; // 가맹점 MID\n      // var tid = data.data.TID; // 거래고유번호\n      // var amt = data.data.Amt; // 금액\n      // var moid = data.data.MOID; // 주문번호\n      // var authdate = data.data.AuthDate; // 승인일자\n      // var authcode = data.data.AuthCode; // 승인번호\n      // var resultcode = data.data.ResultCode; // 결과코드(PG)\n      // var resultmsg = data.data.ResultMsg; // 결과메세지(PG)\n      // var errorcode = data.data.ErrorCode; // 에러코드(상위기관)\n      // var errormsg = data.data.ErrorMsg; // 에러메세지(상위기관)\n      // var EPayCl = data.data.EPayCl;\n      if (result.ResultCode === \"3001\") {\n        postPayment(result);\n      } else {\n        alert(\"결제 오류가 발생했습니다.\");\n        window.removeEventListener(\"message\", InnoPayResult);\n      }\n    }\n  };\n\n  //* 이노페이 결제 (결제 함수 1번 째)\n  const handleInnoPay = async () => {\n    const code = `${moment().format(\"YYYYMMDDHHmmss\")}`;\n    //@ts-ignore\n    innopay.goPay({\n      // 필수 파라미터\n      PayMethod: \"CARD\", // 결제수단(CARD,BANK,VBANK,CARS,CSMS,DSMS,EPAY,EBANK)\n      MID: REACT_APP_INNOPAY_MID, // 가맹점 MID\n      MerchantKey: REACT_APP_INNOPAY_MERCHANTKEY, // 가맹점 라이센스키\n      GoodsName: paymentInput.title, // 상품명\n      Amt: String(paymentInput.price), // 결제금액(과세)\n      BuyerName: User?.user?.name, // 고객명\n      BuyerTel: User?.user?.phone, // 고객전화번호\n      BuyerEmail: User?.user?.email, // 고객이메일\n      ResultYN: \"Y\", // 결제결과창 출력유뮤\n      Moid: `finbig${code}`, // 가맹점에서 생성한 주문번호 셋팅\n      Currency: \"\", // 통화코드가 원화가 아닌 경우만 사용(KRW/USD)\n    });\n    //* 결제 결과가 아래로 전달 (InnoPayResult 함수 실행)\n    window.addEventListener(\"message\", InnoPayResult);\n  };\n\n  //* 이노페이 결제 성공시 골드 충전 함수 (결제 함수 3번 째)\n  const postPayment = async (result: any) => {\n    try {\n      // const code = `${moment().format(\"YYYYMMDDHHmmss\")}`;\n      const { data } = await createSubscription({\n        variables: {\n          input: {\n            data: {\n              title: paymentInput.title,\n              period: paymentInput.period,\n              price: paymentInput.price,\n              user: String(userId),\n              MID: result.MID,\n              paymentStatus: \"결제 완료\",\n              paymentMethod: \"CARD\",\n            },\n          },\n        },\n      });\n      if (User?.user?.isSubscribe) {\n        handleAlreadySubscriptionUser(\n          data?.createSubscriptionHistory?.subscriptionHistory?.period\n        );\n      } else {\n        handelUpdateSubscriptionUser(\n          data?.createSubscriptionHistory?.subscriptionHistory?.created_at,\n          data?.createSubscriptionHistory?.subscriptionHistory?.period\n        );\n      }\n    } catch (e) {\n      alert(\"골드 충전에 오류가 발생했습니다. 관리자에게 문의해주세요.\");\n    }\n  };\n\n  //* 유저의 구독 기간 업데이트\n  const handelUpdateSubscriptionUser = async (createdAt: any, period: any) => {\n    try {\n      await updateSubscriptionUser({\n        variables: {\n          input: {\n            data: {\n              isSubscribe: true,\n              subscriptionDate: createdAt,\n              expirationDate: new Date(\n                dayjs(createdAt).add(period, \"month\").format()\n              ),\n            },\n            where: {\n              id: String(userId),\n            },\n          },\n        },\n      });\n\n      alert(\"구독 정보가 업데이트 됐습니다\");\n    } catch (e) {\n      alert(\"오류가 발생했습니다.\");\n    } finally {\n      handleClose();\n    }\n  };\n\n  //* 이미 구독 중일 때 재구독 하는 경우\n  const handleAlreadySubscriptionUser = async (period: any) => {\n    const newDate = new Date(\n      dayjs(User?.user?.expirationDate).add(period, \"month\").format()\n    );\n    try {\n      await updateSubscriptionUser({\n        variables: {\n          input: {\n            data: {\n              isSubscribe: true,\n              expirationDate: newDate,\n            },\n            where: {\n              id: String(userId),\n            },\n          },\n        },\n      });\n      alert(\"구독 상품 결제가 완료됐습니다.\");\n    } catch (e) {\n      alert(\"오류가 발생했습니다.\");\n    } finally {\n      handleClose();\n    }\n  };\n\n  return (\n    <>\n      <HelmetProvider>\n        <Helmet>\n          <script\n            type=\"text/javascript\"\n            src=\"https://pg.innopay.co.kr/ipay/js/jquery-2.1.4.min.js\"\n          ></script>\n          <script\n            type=\"text/javascript\"\n            src=\"https://pg.innopay.co.kr/ipay/js/innopay-2.0.js\"\n            charSet=\"utf-8\"\n          ></script>\n        </Helmet>\n      </HelmetProvider>\n      <LicensePresenter\n        handleBuy={handleBuy}\n        setPaymentInput={setPaymentInput}\n        paymentInput={paymentInput}\n        open={open}\n        handleOpen={handleOpen}\n        handleClose={handleClose}\n      />\n    </>\n  );\n};\n\nexport default LicenseContainer;\n","export function priceToString(price: any) {\n  return price.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n}\n"],"sourceRoot":""}